<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow title="新增分类" xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:mc="pop.video.*" layout="absolute" width="454" height="256" showCloseButton="true" close="closeThis()">

	<mx:RemoteObject id="videoTypeService" destination="videoTypeService" showBusyCursor="true">
		<mx:method name="addVideoType" result="addVideoTypeHandler(event)"/>
	</mx:RemoteObject>

<mx:Script>
<![CDATA[
	import mx.managers.PopUpManager;
	import mx.controls.Alert;
	import dto.security.video.VideoType;
	import mx.rpc.events.ResultEvent;

	[Bindable]
	public var typeNameTmp:String;
	
	public var typeIdTmp:String;
	public var fatherFunction:Function;
	public var fatherFunction2:Function;
	/**
	 * 关闭窗口
	 * */
	private function closeThis():void{
		PopUpManager.removePopUp(this);
	}
	
	/**
	 * 新增视频分类信息
	 * */
	private function addVideoType():void
	{
		var videoType:VideoType =new VideoType();
		var temp:int = parseInt(typeIdTmp);
		videoType.typeName = typeName.text;
		if(typeIdTmp=="typeDate"||typeIdTmp=="all")
		{
			videoTypeService.addVideoType(videoType,-1);
		}
		else
		{
			videoTypeService.addVideoType(videoType,temp);
		}
	}
	
	/**
	 * 新增视频分类信息响应调用
	 * */
	private function addVideoTypeHandler(event:ResultEvent):void{
		if(event.result!=null){
			Alert.show("视频分类新增成功","提示信息");
		}
		closeThis();
		fatherFunction();
		fatherFunction2();
	}
]]>
</mx:Script>

	<mx:VBox width="100%" height="100%">
		<mx:Form>
			<mx:FormHeading label="分类信息"/>
			<mx:FormItem label="分类名称:" required="true">
				<mx:TextInput id="typeName" maxChars="32" />
			</mx:FormItem>
			<mx:FormItem label="所属分类:">
				<mx:Text text="{typeNameTmp}"/>
			</mx:FormItem>
		</mx:Form>
		<mx:ControlBar width="100%" horizontalAlign="center">
			<mx:Button id="cmdOk" label="确定"/>
			<mx:Button label="取消" click="closeThis()"/>
		</mx:ControlBar>
	</mx:VBox>

	<mx:StringValidator
		source="{typeName}" property="text"
		required="true" requiredFieldError="请输入分类名称"  		  
		trigger="{cmdOk}" triggerEvent="click"
		valid="addVideoType()" invalid="Alert.show('请输入分类名称')"/>
</mx:TitleWindow>
